<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="vu.lt.mybatis.dao.PackageMapper">
  <resultMap id="BaseResultMap" type="vu.lt.mybatis.model.Package">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 08 22:01:34 EEST 2022.
    -->
    <id column="ID" jdbcType="INTEGER" property="id" />
    <result column="PACKAGE_SHIP_ADDRESS" jdbcType="VARCHAR" property="packageShipAddress" />
    <result column="PACKAGE_WEIGHT" jdbcType="DOUBLE" property="packageWeight" />
    <result column="RECEIVER_ID" jdbcType="INTEGER" property="receiverId" />
    <result column="SENDER_ID" jdbcType="INTEGER" property="senderId" />
    <association property="receiver" column="receiver_id" javaType="vu.lt.mybatis.model.Customer" select="selectCustomer"/>
    <association property="sender" column="sender_id" javaType="vu.lt.mybatis.model.Customer" select="selectCustomer"/>
    <collection property="couriers" javaType="ArrayList"
                ofType="Employee" column="couriers_id"
                select="selectCouriers"/>
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 08 22:01:34 EEST 2022.
    -->
    delete from PUBLIC.PACKAGE
    where ID = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" keyColumn="ID" keyProperty="id" parameterType="vu.lt.mybatis.model.Package" useGeneratedKeys="true">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 08 22:01:34 EEST 2022.
    -->
    insert into PUBLIC.PACKAGE (PACKAGE_SHIP_ADDRESS, PACKAGE_WEIGHT, 
      RECEIVER_ID, SENDER_ID)
    values (#{packageShipAddress,jdbcType=VARCHAR}, #{packageWeight,jdbcType=DOUBLE}, 
      #{receiverId,jdbcType=INTEGER}, #{senderId,jdbcType=INTEGER})
  </insert>
  <update id="updateByPrimaryKey" parameterType="vu.lt.mybatis.model.Package">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 08 22:01:34 EEST 2022.
    -->
    update PUBLIC.PACKAGE
    set PACKAGE_SHIP_ADDRESS = #{packageShipAddress,jdbcType=VARCHAR},
      PACKAGE_WEIGHT = #{packageWeight,jdbcType=DOUBLE},
      RECEIVER_ID = #{receiverId,jdbcType=INTEGER},
      SENDER_ID = #{senderId,jdbcType=INTEGER}
    where ID = #{id,jdbcType=INTEGER}
  </update>
  <select id="selectCustomer" resultMap="vu.lt.mybatis.dao.CustomerMapper.BaseResultMap">
    select * from public.customer where id = #{id}
  </select>
  <select id="selectCouriers" resultMap="vu.lt.mybatis.dao.EmployeeMapper.BaseResultMap">
    select * from public.employee e
        join public.employee_package ep on ep.couriers_id = e.id
    where ep.deliveries_id = #{id}
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 08 22:01:34 EEST 2022.
    -->
    select ID, PACKAGE_SHIP_ADDRESS, PACKAGE_WEIGHT, RECEIVER_ID, SENDER_ID
    from PUBLIC.PACKAGE
    where ID = #{id,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 08 22:01:34 EEST 2022.
    -->
    select ID, PACKAGE_SHIP_ADDRESS, PACKAGE_WEIGHT, RECEIVER_ID, SENDER_ID
    from PUBLIC.PACKAGE
  </select>
  <select id="selectAvailableDeliveries" resultMap="vu.lt.mybatis.dao.PackageMapper.BaseResultMap">
    select p.id, p.package_ship_address, p.package_weight, p.receiver_id, p.sender_id
    from public.package p
        left join public.employee_package ep on p.id = ep.deliveries_id
    where deliveries_id is null
  </select>
</mapper>